!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).SVGInjector={})}(this,(function(t){"use strict";var e=function(t){return t.cloneNode(!0)},r=function(){return"file:"===window.location.protocol},n=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){try{if(4===n.readyState){if(404===n.status||null===n.responseXML)throw new Error(r()?"Note: SVG injection ajax calls do not work locally without adjusting security settings in your browser. Or consider using a local webserver.":"Unable to load SVG file: "+t);if(!(200===n.status||r()&&0===n.status))throw new Error("There was a problem injecting the SVG: "+n.status+" "+n.statusText);e(null,n)}}catch(t){e(t,n)}},n.open("GET",t),n.overrideMimeType&&n.overrideMimeType("text/xml"),n.send()},i=new Map,o={},l=function(t,e){o[t]=o[t]||[],o[t].push(e)},a=function(t,r){if(i.has(t)){var a=i.get(t);return a instanceof SVGElement?void r(null,e(a)):a instanceof Error?void r(a):void l(t,r)}i.set(t,void 0),l(t,r),n(t,(function(r,n){r?i.set(t,r):n.responseXML instanceof Document&&n.responseXML.documentElement&&n.responseXML.documentElement instanceof SVGElement&&i.set(t,n.responseXML.documentElement),function(t){for(var r=function(r,n){setTimeout((function(){if(Array.isArray(o[t])){var n=i.get(t),l=o[t][r];n instanceof SVGElement&&l(null,e(n)),n instanceof Error&&l(n),r===o[t].length-1&&delete o[t]}}),0)},n=0,l=o[t].length;n<l;n++)r(n)}(t)}))},s=function(t,e){n(t,(function(t,r){t?e(t):r.responseXML instanceof Document&&r.responseXML.documentElement&&r.responseXML.documentElement instanceof SVGElement&&e(null,r.responseXML.documentElement)}))},u=0,c=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],l=0,a=o.length;l<a;l++,i++)n[i]=o[l];return n},f=[],d={},p="http://www.w3.org/1999/xlink",v=function(t,e,r,n,i,o){var l=t.getAttribute("data-src")||t.getAttribute("src");if(l&&/\.svg/i.test(l)){if(-1!==f.indexOf(t))return f.splice(f.indexOf(t),1),void(t=null);f.push(t),t.setAttribute("src",""),(n?a:s)(l,(function(n,a){if(!a)return f.splice(f.indexOf(t),1),t=null,void o(n);var s=t.getAttribute("id");s&&a.setAttribute("id",s);var v=t.getAttribute("title");v&&a.setAttribute("title",v);var h=t.getAttribute("width");h&&a.setAttribute("width",h);var m=t.getAttribute("height");m&&a.setAttribute("height",m);var g=Array.from(new Set(c((a.getAttribute("class")||"").split(" "),["injected-svg"],(t.getAttribute("class")||"").split(" ")))).join(" ").trim();a.setAttribute("class",g);var A=t.getAttribute("style");A&&a.setAttribute("style",A),a.setAttribute("data-src",l);var b=[].filter.call(t.attributes,(function(t){return/^data-\w[\w-]*$/.test(t.name)}));if(Array.prototype.forEach.call(b,(function(t){t.name&&t.value&&a.setAttribute(t.name,t.value)})),r){var y,w,E,x,S={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],path:[],pattern:["fill","stroke"],radialGradient:["fill","stroke"]};Object.keys(S).forEach((function(t){w=S[t];for(var e=function(t,e){var r;x=(E=y[t].id)+"-"+ ++u,Array.prototype.forEach.call(w,(function(t){for(var e=0,n=(r=a.querySelectorAll("["+t+'*="'+E+'"]')).length;e<n;e++){var i=r[e].getAttribute(t);i&&!i.match(new RegExp('url\\("?#'+E+'"?\\)'))||r[e].setAttribute(t,"url(#"+x+")")}}));for(var n=a.querySelectorAll("[*|href]"),i=[],o=0,l=n.length;o<l;o++){var s=n[o].getAttributeNS(p,"href");s&&s.toString()==="#"+y[t].id&&i.push(n[o])}for(var c=0,f=i.length;c<f;c++)i[c].setAttributeNS(p,"href","#"+x);y[t].id=x},r=0,n=(y=a.querySelectorAll(t+"[id]")).length;r<n;r++)e(r)}))}a.removeAttribute("xmlns:a");for(var j,k,M=a.querySelectorAll("script"),G=[],L=0,X=M.length;L<X;L++)(k=M[L].getAttribute("type"))&&"application/ecmascript"!==k&&"application/javascript"!==k&&"text/javascript"!==k||((j=M[L].innerText||M[L].textContent)&&G.push(j),a.removeChild(M[L]));if(G.length>0&&("always"===e||"once"===e&&!d[l])){for(var T=0,V=G.length;T<V;T++)new Function(G[T])(window);d[l]=!0}var q=a.querySelectorAll("style");Array.prototype.forEach.call(q,(function(t){t.textContent+=""})),a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("xmlns:xlink",p),i(a),t.parentNode&&t.parentNode.replaceChild(a,t),f.splice(f.indexOf(t),1),t=null,o(null,a)}))}else o(new Error("Attempted to inject a file with a non-svg extension: "+l))};t.SVGInjector=function(t,e){var r=void 0===e?{}:e,n=r.afterAll,i=void 0===n?function(){}:n,o=r.afterEach,l=void 0===o?function(){}:o,a=r.beforeEach,s=void 0===a?function(){}:a,u=r.cacheRequests,c=void 0===u||u,f=r.evalScripts,d=void 0===f?"never":f,p=r.renumerateIRIElements,h=void 0===p||p;if(t&&"length"in t)for(var m=0,g=0,A=t.length;g<A;g++)v(t[g],d,h,c,s,(function(e,r){l(e,r),t&&"length"in t&&t.length===++m&&i(m)}));else t?v(t,d,h,c,s,(function(e,r){l(e,r),i(1),t=null})):i(0)},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=svg-injector.umd.production.js.map
